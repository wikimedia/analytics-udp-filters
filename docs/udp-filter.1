.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.40.9.
.TH UDP-FILTER "1" "May 2012" "udp-filter V" "User Commands"
.SH NAME
udp-filter \- start udp-filter
.SH SYNOPSIS
udp-filter [domain] [path] [ip-range] <OUTPUT.LOG>
.SH DESCRIPTION
udp\-filter 0.2.6
Copyright \(co 2012 Wikimedia Foundation, Inc.
This is free software; see the source copying conditions. There is NO
warrant; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
.SH OPTIONS
.IP
Either \fB\-\-path\fR or \fB\-\-domain\fR are mandatory (you can use them both, the other command line parameters are optional.
\fB\-p\fR or \fB\-\-path\fR:               the string or multiple strings separated by a comma that indicate what you want to match.
\fB\-d\fR or \fB\-\-domain\fR:             the part of the domain name that you want to match. For example, 'en.m.' would match all English mobile Wikimedia projects.
.TP
\fB\-g\fR or \fB\-\-geocode\fR:
flag to indicate geocode the log, by default turned off.
.TP
\fB\-b\fR or \fB\-\-bird\fR:
parameter that is mandatory when specifying \fB\-g\fR or \fB\-\-geocode\fR. Valid choices are <country>, <region>, <city>, <latlon> and <everything>.
.TP
\fB\-a\fR or \fB\-\-anonymize\fR:
flag to indicate anonymize the log, by default turned off.
.TP
\fB\-i\fR or \fB\-\-ip\fR:
flag to indicate ip\-filter the log, by default turned off. You can supply comma separated ip addresses, or comma\-separated ip\-ranges.
.TP
\fB\-n\fR or \fB\-\-min\-field\-count\fR:
specify the number of fields that a log line contains. Default is 14.
.TP
\fB\-m\fR or \fB\-\-maxmind\fR:
specify alternative path to MaxMind database.
.IP
Current path to region database: /usr/share/GeoIP/GeoIPRegion.dat
Current path to city database: /usr/share/GeoIP/GeoIPCity.dat
.TP
\fB\-c\fR or \fB\-\-country\-list\fR:
limit the log to particular countries, this should be a comma separated list of country codes. Valid country codes are the ISO 3166 country codes (see http://www.maxmind.com/app/iso3166).
.TP
\fB\-s\fR or \fB\-\-http\-status\fR:
match only lines with these HTTP response status code(s).
.TP
\fB\-r\fR or \fB\-\-regex\fR:
the parameters \fB\-p\fR, \fB\-u\fR and \fB\-s\fR are interpreted as regular expressions. Regular expression searching is probably slower so substring matching is recommended.
.TP
\fB\-f\fR or \fB\-\-force\fR:
do not match on either domain, path, or ip address, basically turn filtering off. Can be useful when filtering for specific country.
.TP
\fB\-v\fR or \fB\-\-verbose\fR:
output detailed debug information to stderr, not recommended in production.
.TP
\fB\-h\fR or \fB\-\-help\fR:
show this menu with all command line options.
.TP
\fB\-V\fR or \fB\-\-version\fR
show version info.
.SH EXAMPLES
udp_filter \-d en.wikipedia this will log all pageviews (depending 
on the sampling rate) if the domain contains en.wikipedia
.P
udp_filter \-p SOPO this will log all pageviews (depending 
on the sampling rate) when the url (excluding the domain name) contains SOPA.
So this will collect SOPA *across* projects.
.P
udp_filter \-d en.wikipedia \-p SOPA this will log all pageviews (depending 
on the sampling rate) where the domain contains en.wikipedia and the url 
contains SOPA.
.P
udp_filter \-d en.wikipedia \-p SOPA,PIPA this will log all pageviews (
depending on the sampling rate) where the domain contains en.wikipedia and the 
url contains either SOPA or PIPA.
.P
udp_filter \-d en.wikipedia \-a this will log all pageviews (depending 
on the sampling rate) if the domain contains en.wikipedia and replace the 
ip address of the visitor with 0.0.0.0
.P
udp_filter \-d en.wikipedia \-g this will log all pageviews (depending 
on the sampling rate) if the domain contains en.wikipedia and replace the 
ip address of the visitor with the country code. See for a list of all the 
valid country codes: http://www.maxmind.com/app/iso3166
.P
udp_filter \-d en.wikipedia \-g \-c BA \-b country this will log all pageviews (depending 
on the sampling rate) if the domain contains en.wikipedia and replace the ip 
address of the visitor with the country code. In addition, only hits from Brasil 
(BA) will be logged.
.P
udp_filter \-d en.wikipedia \-g \-m GeoIP.dat this specifies an alternative path 
for the MaxMind database and this will log all pageviews (depending 
on the sampling rate) if the domain contains en.wikipedia.
.P
udp_filter \-d en.wikipedia \-p SOPA \-c US \-b country this will log all pageviews 
(depending on the sampling rate) where the domain contains en.wikipedia and 
the url contains SOPA and the visitor comes from the US. 
.P
udp_filter \-d en.wikipedia \-v this turns on verbose logging and can 
help in debugging and verifying that the appropriate hits are being logged.
This setting is not recommended in production.
.SH BUGS
No known bugs, but let me know if you find any.
.SH AUTHOR
Written by Diederik van Liere (dvanliere@wikimedia.org).
Wikimedia's generic UDP filtering system.
This new filter system replaces the old collection of filters written in C. It is highly customizable and can be fully configured using the command line.
