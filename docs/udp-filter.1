.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.40.4.
.TH UDP-FILTER "1" "September 2012" "udp-filter 0.2.6" "User Commands"
.SH NAME
udp-filter
.SH SYNOPSIS
.B udp-filter
[\fIOPTION\fR] ...
.SH DESCRIPTION
udp\-filter 0.2.6
.PP
Wikimedia's generic webserver access log filtering system.
This new filter system replaces the old collection of udp2log filters written in C.
It is customizable and can be configured using the command line.
.SH OPTIONS
.TP
\fB\-p\fR paths, \fB\-\-path\fR=\fIpaths\fR
Path portions of the request URI to match.  Comma separated
.TP
\fB\-d\fR domains, \fB\-\-domain\fR=\fIdomain\fR
Parts of domain names to match.  Comma separated.
.TP
\fB\-i\fR addresses, \fB\-\-ip\fR=\fIaddresses\fR
IP address(es) to match.  Comma seperated.  Accepts IPv4
and IPv6 addresses and CIDR ranges.
.TP
\fB\-c\fR countries, \fB\-\-country\-list\fR=\fIcountries\fR Filter for countries.
This should be a comma separated
list of country codes. Valid country codes are the
ISO 3166 country codes (see http://www.maxmind.com/app/iso3166).
.TP
\fB\-s\fR status, \fB\-\-http\-status\fR=\fIstatus\fR
Filter for HTTP response status code(s).
.TP
\fB\-r\fR pattern, \fB\-\-regex\fR=\fIpattern\fR
The parameters \fB\-p\fR, \fB\-u\fR and \fB\-s\fR are interpreted as regular
expressions. Regular expression searching is probably
slower so substring matching is recommended.
.TP
\fB\-g\fR, \fB\-\-geocode\fR
Turns on geocoding of IP addresses.
Must also specify \fB\-\-bird\fR.
.TP
\fB\-b\fR bird, \fB\-\-bird\fR=\fIbird\fR
Mandatory when specifying \fB\-\-geocode\fR.  Valid choices are
<country>, <region>, <city>, <latlon> and <everything>.
.TP
\fB\-a\fR, \fB\-\-anonymize\fR[=\fIsalt\-key\fR]
Turns on IP addresses anonymization.  If salt\-key is given, then
libanon will be used to do prefix preserviing anonymization.
salt\-key may be 'random' a string at least 32 characters long.
If 'random' is given, then a random salt\-key will be chosen.
.TP
\fB\-n\fR count, \fB\-\-min\-field\-count\fR=\fIcount\fR
Minimum number of fields that a log line contains.
Default is 14.  If a line has fewer than this number of
fields,the line will be discarded.
.TP
\fB\-m\fR path, \fB\-\-maxmind\fR=\fIpath\fR
Alternative path to MaxMind database.  Default /usr/share/GeoIP.
.TP
\fB\-f\fR, \fB\-\-force\fR:
Do not match on either domain, path, or ip addres.
Essentially turns filtering off. Can be useful when filtering
for specific country.
.TP
\fB\-v\fR, \fB\-\-verbose\fR
Output detailed debug information to stderr, not recommended
in production.
.TP
\fB\-h\fR, \fB\-\-help\fR
Show this help message.
.TP
\fB\-V\fR, \fB\-\-version\fR
Show version info.
.PP
Wikimedia's generic webserver access log filtering system.
This new filter system replaces the old collection of udp2log filters written in C.
It is customizable and can be configured using the command line.
.SH EXAMPLES
	udp-filter \-d en.wikipedia

Outputs logs if the domain contains en.wikipedia.
.P
	udp-filter \-p SOPO

Outputs logs when the path portion of the URI contains SOPA.
.P
	udp-filter \-d en.wikipedia \-p

Outputs logs where the domain contains en.wikipedia and the url contains SOPA.
.P
	udp-filter \-d en.wikipedia \-p SOPA,PIPA

Outputs logs where the domain contains en.wikipedia and the url contains
either SOPA or PIPA.
.P
	udp-filter \-d en.wikipedia \--anonymize

Outputs logs if the domain contains en.wikipedia and replaces the ip address
of the visitor with 0.0.0.0.
.P
	udp-filter \-d en.wikipedia \--anomymize=random

Outputs logs if the domain contains en.wikipedia and replaces the ip address
of the visitor with a libanon prefix preserved anonymized IP.  This uses a
random salt key to hash the original IP address, so the anonymized IPs will
be different on each invocation.
.P
	udp-filter \-d en.wikipedia \--anonymize=012345678901234567890123456789012

Outputs logs if the domain contains en.wikipedia and replaces the ip address
of the visitor with a libanon prefix preserved anonymized IP.  This specifies
a salt key to hash the original IP address, so the anonymized IPs will be
the same on each invocation
.P
	udp-filter \-d en.wikipedia \-g -b country

Outputs logs in which the domain contains en.wikipedia and insert the
visitor's geocoded country code next to the IP address.  See for a list of all the valid country codes:
http://www.maxmind.com/app/iso3166
.P
	udp-filter \-d en.wikipedia \-g \-c BA \-b country

Outputs logs if the domain contains en.wikipedia and insert the visitor's
geocoded country code next to the IP address. In addition, only hits from
Brasil.
(BA) will be logged.
.P
	udp-filter \-d en.wikipedia \-g \-m /usr/share/local/GeoIP

Specifies an alternative path for the Maxmind database files and outputs
logs in which the the domain contains en.wikipedia.
.P
	udp-filter \-d en.wikipedia \-p SOPA \-c US \-b country 

Outputs logs where the domain contains en.wikipedia and the url contains SOPA and the visitor comes from the US.
.P
	udp-filter -i 71.190.22.0/24,197.30.159.0/22,2607:f0d0:1002:51::/64

Outputs logs where the visitor's IP is either in the 71.190.22.0/24 subnet
or in the 2607:f0d0:1002:51::/64 IPv6 subnet.
.P
	udp-filter \-d en.wikipedia \-v

Turns on verbose logging and can help in debugging and verifying that the
appropriate hits are being logged. This setting is not recommended in
production.
.SH BUGS
No known bugs, but let me know if you find any.
.SH AUTHOR
Written by Diederik van Liere (dvanliere@wikimedia.org).
udp\-filter 0.2.6
.PP
Wikimedia's generic webserver access log filtering system.
This new filter system replaces the old collection of udp2log filters written in C.
It is customizable and can be configured using the command line.
.PP
Written by Diederik van Liere (dvanliere@wikimedia.org).
.TP
One of \fB\-\-path\fR, \fB\-\-ip\fR or \fB\-\-domain\fR are mandatory.
You can use all three, but you must give at least one of them.
.PP
Written by Diederik van Liere (dvanliere@wikimedia.org).
.SH COPYRIGHT
Copyright \(co 2012 Wikimedia Foundation, Inc.
.br
This is free software; see the source copying conditions. There is NO
warrant; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
.PP
.br
Copyright \(co 2012 Wikimedia Foundation, Inc.
.br
This is free software; see the source copying conditions. There is NO
warrant; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
.PP
.br
Copyright \(co 2012 Wikimedia Foundation, Inc.
.br
This is free software; see the source copying conditions. There is NO
warrant; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
